# Контекст проекта (резюме проделанной работы)

Этот файл — краткое восстановление контекста по изменениям, сделанным в проекте Arkanoid/SnakeGame (блоки, бонусы, эффекты, очки).

## Главные изменения

### 1) Блоки и фабрика
- Добавлен паттерн **Factory** для создания игровых объектов: `SnakeGame/GameObjectFactory.h/.cpp`.
- В `Game::initializeBlocks()` (файл `SnakeGame/Game.cpp`) создание блоков переведено на фабрику.
- Удалён `BonusBlock` и все упоминания о нём (бонусы теперь выпадают с вероятностью из любых ломаемых блоков).

### 2) Бонусы (падающие объекты)
- Падающий бонус реализован в `SnakeGame/FallingBonus.h/.cpp`.
- Бонус имеет `BonusType`: `PADDLE_SIZE`, `SPEED`, `ARMOR`.
- Цвета падающих бонусов (визуальные подсказки):
  - `PADDLE_SIZE` — синий
  - `SPEED` — зелёный
  - `ARMOR` — золотой

### 3) Эффекты бонусов (Strategy pattern)
- Реализован паттерн **Strategy**: `SnakeGame/BonusEffect.h/.cpp`.
- 3 эффекта:
  - `PaddleSizeEffect` — увеличивает платформу (платформа остаётся белой).
  - `SpeedBallEffect` — ускоряет шарик и делает его зелёным; при завершении возвращает скорость **без смены направления** (восстановление по модулю скорости, направление берётся текущее).
  - `ArmorBallEffect` — бронебойный шарик (золотой цвет + флаг бронебойности).
- Длительность эффектов сейчас: **5 секунд** (см. конструкторы эффектов в `BonusEffect.cpp`).
- Эффекты **не стакаются**: при сборе нового бонуса старый эффект снимается (`remove()`), затем применяется новый (`apply()`).

### 4) Интеграция в игровой цикл
Файл: `SnakeGame/Game.cpp`

- **Спавн бонусов** при уничтожении блока:
  - вероятность сейчас: **10%**
  - позиция бонуса: центр разрушенного блока
- **Обновление** падающих бонусов: каждый кадр `bonus->update(deltaTime)`, удаление если улетел ниже экрана.
- **Отрисовка** бонусов: в `Game::draw()` рисуются все элементы из `fallingBonuses`.
- **Сбор бонусов платформой**: если `bonusBounds.intersects(paddleBounds)`, вызывается `applyBonusEffect(bonusType)` и бонус удаляется из вектора.
- **Таймер эффекта**: каждый кадр `currentEffect->update(deltaTime)`; при окончании времени эффект снимается и `currentEffect` очищается.
- **Рестарт** (`Game::restartGame()`): очищаются `fallingBonuses` и активный эффект (`currentEffect`), чтобы бонусы/эффекты не “переезжали” в новую игру.

### 5) Бронебойность
Файл: `SnakeGame/Game.cpp`, метод `Game::checkBallBlocksCollisions(...)`.

- Если шарик бронебойный (`ball.isArmorActive()`):
  - блок **уничтожается сразу** (включая неубиваемые),
  - шарик **не отражается** от блока (пролетает насквозь),
  - начисляются очки за блок,
  - может выпасть бонус по вероятности.

### 6) Очки за блоки (1–2–3–4)
Файлы: `SnakeGame/Block.h` (и логика начисления в `SnakeGame/Game.cpp`).

- В `Block` добавлен виртуальный метод `getPoints()`.
- Начисление при уничтожении блока теперь идёт через `block->getPoints()`:
  - `SimpleBlock` → 1
  - `StrongBlock` → 2
  - `TripleBlock` → 3
  - `UnbreakableBlock` → 4 (если уничтожен бронебойным шариком)

### 7) Победа (Victory)
Файл: `SnakeGame/Game.cpp`, метод `Game::isVictory()`.

- Победа наступает, когда на поле **не осталось ломаемых блоков**.
- Неубиваемые блоки **не мешают победе**.
- Уничтоженные блоки удаляются из `blocks`, поэтому `isVictory()` проверяет оставшиеся блоки на “ломаемость”.

### 8) Платформа: “инерция/скольжение”
Файл: `SnakeGame/Paddle.cpp`.

- Были правки расчёта `currentVelocityX`, чтобы уменьшить “скольжение”.
- Полностью проблема может проявляться при резких изменениях/особенностях ввода (особенно мышью); пока оставлено “как стало лучше”.

## Где что менять (быстро)

- **Вероятность выпадения бонусов**: `SnakeGame/Game.cpp` — условия вида `(rand() % 100) < ...`.
- **Длительность эффектов**: `SnakeGame/BonusEffect.cpp` — `BonusEffect(5.0f)` в конструкторах эффектов.
- **Очки за блоки**: `SnakeGame/Block.h` — `getPoints()` в каждом классе блока.
- **Логика бронебойности (пролет насквозь)**: `SnakeGame/Game.cpp` — `checkBallBlocksCollisions(...)`.
- **Victory**: `SnakeGame/Game.cpp` — `isVictory()`.

## Важное про Visual Studio проект

Файл проекта: `SnakeGame/SnakeGame.vcxproj`
- Добавлены в сборку новые файлы `.cpp/.h`:
  - `BonusEffect.*`
  - `FallingBonus.*`
  - `GameObjectFactory.*`

Если в новом окружении файлы “не видны”/не компилируются — перепроверь, что они есть в `.vcxproj` и выполнен rebuild.


